<!DOCTYPE html>
<html lang="zh-CN">

<!-- Head tag -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!--Description-->
  
  <meta name="description" content="æƒ³å†™ä»€ä¹ˆå†™ä»€ä¹ˆï¼Œblablabla">
  

  <!--Author-->
  
  <meta name="author" content="Wttttttå¤©">
  

  <!--Open Graph Title-->
  
      <meta property="og:title" content="iOS - æŒ‰çº¯è‰²è¡Œåˆ‡é¡µ"/>
  
  <!--Open Graph Description-->
  
      <meta property="og:description" content="æƒ³å†™ä»€ä¹ˆå†™ä»€ä¹ˆï¼Œblablabla" />
  
  <!--Open Graph Site Name-->
  <meta property="og:site_name" content="Wttttttå¤©"/>
  <!--Type page-->
  
      <meta property="og:type" content="article" />
  
  <!--Page Cover-->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Title -->
  
  <title>iOS - æŒ‰çº¯è‰²è¡Œåˆ‡é¡µ - Wttttttå¤©</title>


  <link rel="shortcut icon" href="https://hexo.io/icon/favicon-96x96.png">

  <!-- Custom CSS/Sass -->
  <link rel="stylesheet" href="/css/style.css">

  <!----------------------------
  https://github.com/GallenHu/hexo-theme-Daily

 _____            _   _
|  __ \          (_) | |
| |  | |   __ _   _  | |  _   _
| |  | |  / _` | | | | | | | | |
| |__| | | (_| | | | | | | |_| |
|_____/   \__,_| |_| |_|  \__, |
                          __/ |
                         |___/

    --------------------------->

</head>


<body>

  <!-- Nav -->
  <header class="site-header">
  <div class="header-inside">
    <div class="logo">
      <a href="/" rel="home">
        
        <img src="https://hexo.io/logo.svg" alt="Wttttttå¤©" height="60">
        
      </a>
    </div>
    <!-- Navigation -->
    <nav class="navbar">
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse">
        <ul class="navbar-nav">
          
          
            <li>
              <a href="/.">
                
                  home
                
              </a>
            </li>
          
            <li>
              <a href="/archives">
                
                  archive
                
              </a>
            </li>
          
        </ul>
      </div>
      <!-- /.navbar-collapse -->
    </nav>
    <div class="button-wrap">
      <button class="menu-toggle">Primary Menu</button>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="content-area">
  <div class="post">
    <!-- Post Content -->
    <div class="container">
      <article>
        <!-- Title date & tags -->
        <div class="post-header">
          <h1 class="entry-title">
            iOS - æŒ‰çº¯è‰²è¡Œåˆ‡é¡µ
            
          </h1>
          <p class="posted-on">
          2017-03-28
          </p>
          <div class="tags-links">
            
              
            
          </div>
        </div>
        <!-- Post Main Content -->
        <div class="entry-content">
          <p>DTCoreTextåº“æ˜¯iOSç«¯å¯Œæ–‡æœ¬æ¸²æŸ“åº“ï¼Œå¼€å‘é˜…è¯»ç±»äº§å“æ—¶å¯ä»¥ä½¿ç”¨è¯¥åº“è¿›è¡Œå¯Œæ–‡æœ¬æ¸²æŸ“ï¼Œå®ƒæä¾›äº†CSSæ ·å¼è§£æå’ŒHTMLå¯Œæ–‡æœ¬æ ·å¼çš„æ’ç‰ˆï¼Œæ”¯æŒå›¾ç‰‡ã€è§†é¢‘è¿™ç±»é™„ä»¶å†…å®¹çš„æ··åˆæ’ç‰ˆã€‚</p>
<h2><span id="jian-dan-jie-shao">ç®€å•ä»‹ç»</span></h2><p>å®ƒçš„åº•å±‚ä½¿ç”¨çš„Appleæä¾›çš„CoreTextåº“ï¼Œå‘½åå‡ ä¹å’ŒCoreTextåº“ä¿æŒä¸€è‡´ï¼Œä¸Šæ‰‹ç®€å•å¿«é€Ÿï¼Œæ­¥éª¤ååˆ†ç®€å•å®¹æ˜“ï¼š</p>
<ol>
<li><p>åŠ è½½CSSæ ·å¼ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span>* cssPath = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"style"</span> ofType:<span class="string">@"css"</span>];</span><br><span class="line"><span class="built_in">NSString</span>* cssString = [<span class="built_in">NSString</span> stringWithContentsOfFile:cssPath encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">nil</span>] ;</span><br><span class="line">DTCSSStylesheet* css = [[DTCSSStylesheet alloc] initWithStyleBlock:cssString];</span><br><span class="line">[[DTCSSStylesheet defaultStyleSheet] mergeStylesheet:css];</span><br></pre></td></tr></table></figure>
</li>
<li><p>åŠ è½½HTMLå†…å®¹ï¼Œå°†å®ƒè½¬æ¢ä¸ºå¯Œæ–‡æœ¬å¯¹è±¡ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *htmlString = <span class="string">@"TODO"</span>;</span><br><span class="line"><span class="built_in">NSData</span> *data = [htmlString dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line"><span class="built_in">NSAttributedString</span>* attributedContent = [[<span class="built_in">NSAttributedString</span> alloc] initWithHTMLData:data</span><br><span class="line">                                                                                 options:<span class="literal">nil</span></span><br><span class="line">                                                                      documentAttributes:<span class="literal">nil</span>];</span><br><span class="line">DTCoreTextLayouter* layouter = [[DTCoreTextLayouter alloc] initWithAttributedString:attributedContent];</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç”Ÿæˆæ¸²æŸ“å¯¹è±¡ã€‚ï¼ˆåˆ†é¡µå’Œä¸åˆ†é¡µçš„åŒºåˆ«åœ¨äºç”Ÿæˆæ¸²æŸ“å¯¹è±¡æ—¶æŒ‡å®šçš„åˆ†é¡µé«˜åº¦ï¼Œä¸åˆ†é¡µéœ€è¦è®¾ç½®ä¸ºCGFLOAT_HEIGHT_UNKNOWNï¼‰</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾ç”»å¸ƒä¸ºå±å¹•å¤§å°ï¼Œä¸åˆ†é¡µï¼Œæ‰€æœ‰å†…å®¹åœ¨ä¸€é¡µæ˜¾ç¤º</span></span><br><span class="line"><span class="built_in">NSInteger</span> position = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">CGRect</span> rect = [[<span class="built_in">UIScreen</span> mainScreen] bounds];</span><br><span class="line">rect.size.height = <span class="built_in">CGFLOAT_HEIGHT_UNKNOWN</span>;</span><br><span class="line">DTCoreTextLayoutFrame *layoutFrame = [dtLayouter layoutFrameWithRect:rect range:<span class="built_in">NSMakeRange</span>(position, <span class="number">0</span>)]; <span class="comment">// æ¸²æŸ“å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡è®¾ç”»å¸ƒä¸ºå±å¹•å¤§å°ï¼ŒæŒ‰ç…§å±å¹•å¤§å°åˆ†é¡µ</span></span><br><span class="line"><span class="built_in">NSInteger</span> position = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">CGRect</span> rect = [[<span class="built_in">UIScreen</span> mainScreen] bounds];</span><br><span class="line">DTCoreTextLayoutFrame *layoutFrame = [dtLayouter layoutFrameWithRect:rect range:<span class="built_in">NSMakeRange</span>(position, <span class="number">0</span>)]; <span class="comment">// æ¸²æŸ“å¯¹è±¡</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>ä¸Šé¢ä»£ç ä¸­ä½¿ç”¨äº†å®ƒæä¾›çš„ä¸€ä¸ªç®€å•æ˜“æ‡‚çš„åˆ†é¡µAPIï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> Creates a layout frame with a given rectangle and string range. The layouter fills the layout frame with as many lines as fit. You can query [DTCoreTextLayoutFrame visibleStringRange] for the range the fits and create another layout frame that continues the text from there to create multiple pages, for example for an e-book.</span><br><span class="line"> @param frame The rectangle to fill with text</span><br><span class="line"> @param range The string range to fill, pass &#123;0,0&#125; for the entire string (as much as fits)</span><br><span class="line"> */</span><br><span class="line">- (DTCoreTextLayoutFrame *)layoutFrameWithRect:(CGRect)frame range:(NSRange)range;</span><br></pre></td></tr></table></figure></p>
<p>è¯¥APIç»™å®šä¸€ä¸ªframeå¤§å°ï¼Œç„¶åå‘Šè¯‰å®ƒä»ä»€ä¹ˆrangeå¼€å§‹åˆ†é¡µï¼Œè¿”å›åˆ‡å¥½çš„å¯Œæ–‡æœ¬æ¸²æŸ“å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†è¯¥é¡µæ‰€æœ‰æ¸²æŸ“çš„lineså’Œattachmentså¯¹è±¡ï¼Œå°†DTCoreTextLayoutFrameè®¾ç½®åˆ°DTAttributedTextContentViewä¸­ï¼Œå³å¯å±•ç¤ºå‡ºåˆ†é¡µçš„å¯Œæ–‡æœ¬å†…å®¹ã€‚</p>
<ol>
<li><p>å°†æ¸²æŸ“å¯¹è±¡ç”»åœ¨è§†å›¾ä¸Šã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DTAttributedTextContentView *attributedTextContentView = [DTAttributedTextContentView new];</span><br><span class="line">attributedTextContentView.frame = [[<span class="built_in">UIScreen</span> mainScreen] bounds];</span><br><span class="line">attributedTextContentView.layoutFrame = layoutFrame;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é™„ä»¶çš„å¤„ç†<br>å¦‚æœå†…å®¹ä¸­æœ‰é™„ä»¶ï¼šå›¾ç‰‡ã€è§†é¢‘ã€å ä½ï¼Œéœ€è¦åœ¨ä»£ç†å›è°ƒä¸­è¿”å›UIViewï¼Œè¯¥viewçš„åæ ‡å’Œå¤§å°æ˜¯åœ¨HTMLä¸­æå‰æŒ‡å®šå¥½çš„ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span> *)attributedTextContentView:(DTAttributedTextContentView *)attributedTextContentView viewForAttachment:(DTTextAttachment *)attachment frame:(<span class="built_in">CGRect</span>)frame &#123;</span><br><span class="line">    <span class="keyword">if</span> ([attachment isKindOfClass:[DTIframeTextAttachment <span class="keyword">class</span>]]) &#123;</span><br><span class="line">        DTWebVideoView *videoView = [[DTWebVideoView alloc] initWithFrame:frame];</span><br><span class="line">        videoView.attachment = attachment;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> videoView;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([attachment isKindOfClass:[DTObjectTextAttachment <span class="keyword">class</span>]]) &#123;</span><br><span class="line">        <span class="comment">// somecolorparameter has a HTML color</span></span><br><span class="line">        <span class="built_in">NSString</span> *colorName = [attachment.attributes objectForKey:<span class="string">@"somecolorparameter"</span>];</span><br><span class="line">        <span class="built_in">UIColor</span> *someColor = DTColorCreateWithHTMLName(colorName);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">UIView</span> *someView = [[<span class="built_in">UIView</span> alloc] initWithFrame:frame];</span><br><span class="line">        someView.backgroundColor = someColor;</span><br><span class="line">        someView.layer.borderWidth = <span class="number">1</span>;</span><br><span class="line">        someView.layer.borderColor = [<span class="built_in">UIColor</span> blackColor].CGColor;</span><br><span class="line"></span><br><span class="line">        someView.accessibilityLabel = colorName;</span><br><span class="line">        someView.isAccessibilityElement = <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> someView;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>ä»…éœ€5æ­¥å°±å¯å®Œæˆå¯Œæ–‡æœ¬çš„æ’ç‰ˆæ¸²æŸ“ï¼Œæ˜¯ä¸æ˜¯ç®€å•ä¸”é«˜æ•ˆï¼Ÿ</p>
<p>ä¸ºäº†å¢åŠ ç”¨æˆ·ç²˜æ€§ï¼Œåœ¨æ¯ä¸ªç« èŠ‚æœ«é¡µå¢åŠ ä½œè€…å¤´åƒã€æ˜µç§°ã€æ„Ÿè¨€å’Œæœ¬ç« ç²¾å½©è¯„è®ºï¼Œè¥é€ ä¸€ä¸ªè‰¯å¥½çš„ç¤¾åŒºç¯å¢ƒï¼Œå¼•èµ·è¯»è€…çš„å…±é¸£ã€‚åœ¨å¼€å‘ç« æœ«éæ­£æ–‡çš„é™„åŠ é¡µï¼ˆä½œå®¶æ„Ÿè¨€ã€ç²¾å½©è¯„è®ºã€æ¨èå†…å®¹ç­‰è‡ªå®šé¡µï¼‰æ—¶ï¼ŒæŠ€æœ¯é¢„è¨€äº†ä¸åŒçš„å‡ ç§æŠ€æœ¯æ–¹æ¡ˆï¼š</p>
<ol>
<li>æ­£æ–‡é¡µå’Œé™„åŠ é¡µéƒ½ä½¿ç”¨DTCoreTextè¿›è¡Œæ’ç‰ˆæ¸²æŸ“ã€‚è¯¥ç§æŠ€æœ¯å®ç°æ–¹å¼åœ¨æŠ€æœ¯é¢„è¨€è¿‡ç¨‹ä¸­å‘ç°ï¼Œéšç€é¡µé¢å¤æ‚åº¦çš„æé«˜ï¼Œæ›²çº¿é™¡å‡å¼çš„æé«˜äº†é™„åŠ é¡µçš„å¼€å‘æˆæœ¬ï¼Œå¤§å¤§å¢åŠ å¼€å‘äººå‘˜çš„å­¦ä¹ æˆæœ¬ï¼Œä¸”DTCoreTextæ”¯æŒçš„CSSæ ·å¼å’ŒHTMLæ ‡ç­¾éå¸¸æœ‰é™ï¼Œå¦‚æœé‡åˆ°è®¾è®¡ç¨¿ä¸­å¤æ‚çš„æ’ç‰ˆæ ·å¼ï¼Œè¿™ç§é£é™©æ— æ„æ˜¯é¢—å®šæ—¶ç‚¸å¼¹ï¼Œæœ€ç»ˆå°†ä¼šå¯¼è‡´é¡¹ç›®éš¾ä»¥æ‰©å±•å’Œç»´æŠ¤ã€‚</li>
<li><p>æ­£æ–‡é¡µä½¿ç”¨DTCoreTextæ’ç‰ˆæ¸²æŸ“ï¼Œé™„åŠ é¡µä½¿ç”¨ä¼ ç»Ÿçš„UIViewå¼€å‘æ–¹å¼ï¼Œè¯¥ç§æŠ€æœ¯å®ç°æ–¹å¼æœ‰2ç§å®Œå…¨ä¸ä¸€æ ·çš„è§£è€¦å®ç°æ–¹æ¡ˆï¼š</p>
<ul>
<li><p>æ–¹æ¡ˆä¸€ï¼šé™„åŠ é¡µè‡ªå¸¦åˆ†é¡µç®—æ³•ï¼Œå³ç¼–å†™é™„åŠ é¡µçš„å¼€å‘äººå‘˜åœ¨ç¼–å†™UIæ—¶ï¼Œéœ€è¦æä¾›ä¸€ä¸ªåˆ†é¡µç®—æ³•ï¼Œå°†å…¶æ‹¼æ¥åˆ°æ­£æ–‡é¡µæœ«ã€‚è¯¥æ–¹æ¡ˆå¯¹å¼€å‘äººå‘˜å¯¹åˆ†é¡µç®—æ³•æŠ€æœ¯è¦æ±‚è¾ƒé«˜ï¼Œéœ€è¦è®¡ç®—æ¯è¡Œçš„æ’ç‰ˆåæ ‡ï¼Œåœ¨åˆ†é¡µè®¡ç®—æ—¶å¯¹æ¯è¡Œè¿›è¡Œåæ ‡ä½ç½®è®¡ç®—ï¼Œæœ€ç»ˆç¡®å®šæ¯é¡µå¡«å……çš„æ¸²æŸ“å†…å®¹ã€‚</p>
</li>
<li><p>æ–¹æ¡ˆäºŒï¼šé™„åŠ é¡µä¸è‡ªå¸¦åˆ†é¡µç®—æ³•ï¼Œç”±ä¸€ä¸ªå…¬å…±çš„åˆ‡é¡µç®—æ³•å¯¹é™„åŠ é¡µè¿›è¡Œé¡µé¢åˆ‡åˆ†ï¼Œéœ€è¦æŠ½è±¡å‡ºåˆ†é¡µçš„è§„åˆ™ï¼Œå®šåˆ¶ä¸€å¥—é™„åŠ é¡µUIå¼€å‘æ ‡å‡†ã€‚è¯¥æ–¹æ¡ˆå¯¹å¼€å‘äººå‘˜è¦æ±‚è¾ƒä½ï¼Œå¼€å‘äººå‘˜æ— éœ€äº†è§£åˆ†é¡µæ’ç‰ˆç®—æ³•ï¼ŒæŒ‰ç…§UIå¼€å‘æ ‡å‡†å®Œæˆç»„ä»¶å¼€å‘åï¼Œäº¤ç”±é˜…è¯»å¼€å‘äººå‘˜ç¼–å†™çš„ç»Ÿä¸€åˆ‡é¡µç®—æ³•å™¨å®Œæˆé™„åŠ é¡µæ¥å…¥æ­£æ–‡é¡µæœ«ã€‚</p>
</li>
</ul>
<p>æ–¹æ¡ˆäºŒæ›´ä¼˜ä¸æ˜¯å—ï¼Ÿä»»ä½•å¼€å‘äººå‘˜éƒ½èƒ½å†™é˜…è¯»ç« æœ«é¡µçš„é™„åŠ UIï¼Œä»æ­¤å†ä¹Ÿä¸å®³æ€•äº§å“å¤§å¤§å¯¹ç« æœ«é™„åŠ é¡µæœ‰å¤©é©¬è¡Œç©ºçš„æƒ³æ³•äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆèµï¼Ÿ</p>
</li>
</ol>
<h2><span id="que-ding-fang-an-qian-de-yi-wen">ç¡®å®šæ–¹æ¡ˆå‰çš„ç–‘é—®</span></h2><ol>
<li>çœŸçš„æœ‰ä¸€ç§é€šç”¨çš„ç®—æ³•æ¥åˆ‡åˆ†ä»»æ„çš„é™„åŠ é¡µå—ï¼Ÿ</li>
<li>å®ƒæ˜¯å¦çœŸçš„ä¸éœ€è¦é™„åŠ é¡µå¼€å‘å‚ä¸åˆ°åˆ†é¡µç®—æ³•çš„å¼€å‘ä¸­ï¼Ÿ</li>
<li>å®ƒæ˜¯å¦èƒ½æ»¡è¶³äº§å“å¤©é©¬è¡Œç©ºçš„æƒ³æ³•å‘¢?</li>
<li>é€šå¸¸ä¸€ä¸ªé€šç”¨çš„ç®—æ³•å¤šå¤šå°‘å°‘ä¼šåœ¨æ€§èƒ½ä¸Šæœ‰ä¸€å®šçš„æŸè€—ï¼Œè¿™ä¸ªæŸè€—åœ¨ç”¨æˆ·ä¾§æ˜¯å¦èƒ½å¿½ç•¥ä¸è®¡å‘¢ï¼Ÿ</li>
<li>å®ƒèƒ½å¦æˆä¸ºSDKï¼Œæä¾›ç»™å…¶ä»–é¡¹ç›®ä½¿ç”¨ï¼Ÿ</li>
</ol>
<h2><span id="ji-zhu-fang-an-que-ding-li-yong-chun-se-xing-jin-xing-fen-ye-pan-duan">æŠ€æœ¯æ–¹æ¡ˆç¡®å®š - åˆ©ç”¨çº¯è‰²è¡Œè¿›è¡Œåˆ†é¡µåˆ¤æ–­</span></h2><p>ç¡®å®šä½¿ç”¨æŠ€æœ¯æ–¹æ¡ˆäºŒä¹‹åï¼Œçºµè§‚APPå†…æ‰€æœ‰UIé¡µé¢ï¼Œèƒ½å¤Ÿå‘ç°åˆ†é¡µç®—æ³•å¯ä»¥ä½¿ç”¨çº¯è‰²è¡Œæ¥åˆ¤æ–­ï¼Œèƒ½å¦åˆ†é¡µè¦çœ‹Yåæ ‡è¿™è¡Œçš„æ¯ä¸ªåƒç´ ç‚¹æ˜¯å¦æ˜¯ä¸€æ ·çš„è‰²å€¼ï¼ˆRGBAå››ä¸ªéƒ½ä¸€æ ·ï¼Œåˆ™è‰²å€¼ç›¸ç­‰ï¼‰ï¼Œå‡è®¾è¿™è¡ŒYåæ ‡ä¸­æœ‰ä¸ä¸€æ ·çš„è‰²å€¼ï¼Œå¯èƒ½æ˜¯è¯¥è¡Œæœ‰æ–‡å­—ã€å›¾ç‰‡ã€æŒ‰é’®ç­‰å†…å®¹ï¼Œè¿™æ—¶åˆ†é¡µçš„Yåæ ‡è¦ç»§ç»­æ¢è¡Œåˆ¤æ–­ã€‚</p>
<p>ä»»ä½•è¿‡æ—©çš„ä¼˜åŒ–éƒ½æ˜¯æµªè´¹æ—¶é—´å’Œç²¾åŠ›ï¼Œæ‰€ä»¥å…ˆå‡è®¾UIè§„èŒƒä¸æç‰¹æ®ŠåŒ–ï¼Œå³ä»»ä½•é¡µé¢éƒ½èƒ½</p>
<p>æŠ€æœ¯é¢„è¨€ä½¿ç”¨DTCoreText + è‡ªå®šä¹‰UIViewæ’ç‰ˆï¼Œå³æ­£æ–‡å†…å®¹ä½¿ç”¨DTCoreTextçš„HTMLæ ¼å¼æ¥è¿›è¡Œæ’ç‰ˆæ¸²æŸ“ï¼Œæœ«é¡µçš„é™„åŠ é¡µä½¿ç”¨UIViewçš„ä¼ ç»Ÿé¡µé¢å¼€å‘æ–¹å¼ï¼Œ<br> äº†2ç§ä¸åŒæ–¹å‘çš„è§£è€¦åšæ³•ï¼š</p>
<p>ä¼˜ç§€çš„APPéƒ½ä¼šå¢åŠ ç”¨æˆ·ç²˜æ€§ï¼Œé˜…è¯»APPä»¥ä¼˜ç§€çš„å†…å®¹å–èƒœï¼Œ</p>
<p>å®é™…çš„å¼€å‘ä¸­è¿˜ä¼šé‡åˆ°DTCoreText + è‡ªå®šä¹‰UIViewæ’ç‰ˆï¼Œäº§å“å¤§å¤§åœ¨æ¯ç« çš„ç« æœ«é¡µæ·»åŠ ç”¨æˆ·é»æ€§é¡µé¢ï¼Œä¾‹å¦‚ä½œå®¶æ„Ÿè¨€ã€ç²¾å½©è¯„è®ºã€æ¨èå†…å®¹ç­‰è‡ªå®šé¡µï¼Œè¿™é‡Œç®€ç§°è¿™äº›éæ­£æ–‡å†…å®¹é¡µé¢ä¸ºé™„åŠ é¡µï¼Œè¯¥é™„åŠ é¡µæ ·å¼å¤æ‚ï¼Œå¦‚æœé™„åŠ é¡µä¹Ÿä½¿ç”¨DTCoreTextåº“ä¸­çš„HTMLã€CSSæ ·å¼æ¥æ¸²æŸ“ï¼Œå¾ˆå¯èƒ½é‡åˆ°è®¸å¤šä¸æ”¯æŒçš„æ ‡ç­¾ï¼ŒåŒæ—¶ä¼šæ”¹å˜å®¢æˆ·ç«¯å¼€å‘ä¹ æƒ¯ï¼Œæ— æ³•ä½¿ç”¨å·²å¼€å‘å¥½çš„å…¬å…±ç»„ä»¶ã€‚å¦‚æœä¸ä½¿ç”¨è¯¥åº“ï¼Œå°±ä¼šé‡åˆ°å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•æŠŠé™„åŠ é¡µè·Ÿéšåœ¨æ­£æ–‡ä¹‹åè¿›è¡Œåˆ†é¡µæ’ç‰ˆï¼Ÿä¾‹å¦‚ï¼šåœ¨æ­£æ–‡æœ«é¡µæ·»åŠ ä¸€ä¸ªä½œè€…å¤´åƒã€åç§°ã€ä½œè€…æ„Ÿè¨€é¡µå’Œæœ¬ç« ç²¾å½©è¯„è®ºï¼Œè¯¥é™„åŠ é¡µéœ€è¦å’Œæ­£æ–‡ä¸€æ ·è¿›è¡Œåˆ†é¡µæ’ç‰ˆï¼Œæ¯ç« çš„é™„åŠ é¡µéƒ½æ˜¯åŠ¨æ€å†…å®¹ï¼Œå³é™„åŠ é¡µæ˜¯åŠ¨æ€é«˜åº¦ã€‚</p>
<p>æ–¹æ¡ˆä¸€ï¼š<br>ç¼–å†™é™„åŠ é¡µä»£ç æ—¶ï¼Œè‡ªå¸¦ç®—æ³•è¿›è¡Œåˆ‡é¡µã€‚è¿™ç§æ–¹æ¡ˆå¯¹å¼€å‘äººå‘˜ç¼–ç èƒ½åŠ›è¦æ±‚è¾ƒé«˜ï¼Œå¼€å‘é¡µé¢æ—¶éœ€å¯¹ä¸åŒæ’ç‰ˆè¿›è¡Œé€‚é…åˆ‡é¡µè§„åˆ™ï¼Œæ¯å¼€å‘ä¸€ä¸ªæ–°é¡µé¢æ—¶ï¼Œéƒ½éœ€è¦è‡ªå¸¦åˆ‡é¡µç®—æ³•ã€‚</p>
<p>æ–¹æ¡ˆäºŒï¼š<br>ç¼–å†™é™„åŠ é¡µä»£ç æ—¶ï¼Œä¸å¸¦ç®—æ³•è¿›è¡Œåˆ†é¡µã€‚è¿™ç§æ–¹æ¡ˆéœ€è¦åˆ¶å®šä¸€å¥—é™„åŠ é¡µå¼€å‘æ ‡å‡†å’Œåˆ‡é¡µè§„åˆ™ï¼Œç¼–å†™é™„åŠ é¡µçš„å¼€å‘äººå‘˜è¦æŒ‰ç…§è¯¥å¥—æ ‡å‡†è¿›è¡Œé¡µé¢å¼€å‘ï¼Œå†äº¤ç”±ç»Ÿä¸€çš„åˆ‡é¡µç®—æ³•è¿›è¡Œåˆ‡é¡µã€‚</p>
<p>é™„åŠ é¡µæ ‡å‡†ï¼š</p>
<ol>
<li>æŒ‰ç…§ä»€ä¹ˆç®—æ³•è¿›è¡Œé¡µé¢åˆ‡åˆ†ã€‚</li>
<li>åˆ‡é¡µåï¼Œå½“ä¸­é¡µé¢çš„é¡¶éƒ¨å’Œåº•éƒ¨é—´è·ã€‚</li>
<li>å°¾é¡µçš„å¤„ç†ã€‚</li>
</ol>
<p>å¼€å‘è¿‡ç¨‹ä¸­åˆéœ€è¦è§£è€¦æ¨¡å—ï¼Œä¸å¸Œæœ›è¿™ä¸ªæ–°å¢çš„é¡µé¢å½±å“åˆ°é˜…è¯»æ¸²æŸ“æœ¬èº«ï¼Œæˆ‘è¿™é‡Œæœ‰ä¸€ç§å°è¯•æ€è·¯ï¼Œå¦‚æœ‰é—®é¢˜å¸Œæœ›è½»æ‹ã€‚</p>
<p>PSï¼šç›®å‰è¿˜æœªè¿ç”¨åˆ°å®é™…é¡¹ç›®ä¸­ï¼Œåªæ˜¯ä¸€ä¸ªè§£è€¦çš„æƒ³æ³•è€Œå·²ğŸ’¡</p>
<h2><span id="jie-jue-si-lu">è§£å†³æ€è·¯</span></h2><ol>
<li>å¦‚ä½•è§£å†³åœ¨å·²æ¸²æŸ“å¥½çš„é˜…è¯»é¡µä¸­åŠ¨æ€åŠ å…¥è‡ªå®šä¹‰é¡µï¼Œä¸å½±å“é˜…è¯»é¡µæ’ç‰ˆåŠŸèƒ½ï¼Œä¸ä¾µå…¥é˜…è¯»ä»£ç ï¼Ÿ<br>ç­”ï¼šå‡è®¾è‡ªå®šé¡µé¢åªæœ‰ä¸€é¡µï¼Œä¸”é«˜åº¦å°±æ˜¯è¯¥é˜…è¯»é¡µæ­£æ–‡æ˜¾ç¤ºå®Œå‰©ä½™çš„åŒºåŸŸï¼Œé‚£ä¹ˆç›´æ¥å°†è‡ªå®šä¹‰é¡µé¢ä»¥addSubViewçš„å½¢å¼åŠ å…¥åˆ°è¯¥é˜…è¯»é¡µã€‚</li>
<li>å½“è‡ªå®šä¹‰é¡µè¶…è¿‡ä¸€å±æ—¶ï¼Œå¦‚ä½•å°½å¯èƒ½å°å½±å“æˆ–ä¸å½±å“é˜…è¯»ç¿»é¡µé€»è¾‘ï¼Ÿ<br>ç­”ï¼šå‰æï¼šç›®å‰æˆ‘ä»¬çš„é˜…è¯»æ¡†æ¶ä¸­æ¯é¡µæ˜¯å¦æœ‰ä¸‹ä¸€é¡µæ˜¯ä¸€ä¸ªåŠ¨æ€è¯¢é—®è¿‡ç¨‹ï¼Œç¿»é¡µæ‰‹åŠ¿ä¼šè¯¢é—®å®¹å™¨ä¸­çš„å½“å‰é¡µæ˜¯å¦æœ‰å‰ã€åä¸€é¡µã€‚ä¿®æ”¹ç‚¹ï¼šè¯¢é—®é€å±‚ä¼ é€’çš„æ€æƒ³ï¼Œä¿®æ”¹åï¼Œé˜…è¯»é¡µä¸­æœ‰è‡ªå®šä¹‰å­é¡µæ—¶ï¼Œåº”ä¼˜å…ˆè¯¢é—®å­é¡µæ˜¯å¦æœ‰ä¸‹ä¸€é¡µï¼Œå¦‚æœæœ‰ï¼Œä¸‹ä¸€é¡µæ˜¾ç¤ºè‡ªå®šä¹‰å­é¡µï¼Œå¦‚æœæ²¡æœ‰ï¼Œå†çœ‹é˜…è¯»é¡µè‡ªèº«æ˜¯å¦æœ‰ä¸‹ä¸€é¡µã€‚</li>
</ol>
<h2><span id="he-xin-ru-he-qie-ye">æ ¸å¿ƒï¼šå¦‚ä½•åˆ‡é¡µ</span></h2><p>è‡ªå®šä¹‰é¡µé¢è½¬ä¸ºåƒç´ dataï¼Œæ³¨æ„ä¸è¦ç”¨é«˜æ¸…ï¼ŒèŠ‚çœå†…å­˜ï¼Œç»™ä¸€ä¸ªèµ·å§‹é”šç‚¹ï¼Œé€è¡Œæ‰«æï¼Œå½“é‡åˆ°è‰²å€¼ä¸ä¸€æ ·æ—¶ï¼Œæ¢è¡Œã€‚<br>ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;</span><br><span class="line">    eFindPureSeparateLinePointDirection_down = <span class="number">0</span>,</span><br><span class="line">    eFindPureSeparateLinePointDirection_up</span><br><span class="line">&#125;eFindPureSeparateLinePointDirection;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIView</span> (<span class="title">WtExt</span>)</span></span><br><span class="line">- (<span class="built_in">CGPoint</span>)wt_findPureSeparateLinePointWithAnchor:(<span class="built_in">CGPoint</span>)point direction:(eFindPureSeparateLinePointDirection)direction;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIView</span> (<span class="title">WtExt</span>)</span></span><br><span class="line">- (<span class="built_in">CGPoint</span>)wt_findPureSeparateLinePointWithAnchor:(<span class="built_in">CGPoint</span>)point direction:(eFindPureSeparateLinePointDirection)direction &#123;</span><br><span class="line">    <span class="keyword">int</span> preR = <span class="number">-1</span>, preG = <span class="number">-1</span>, preB = <span class="number">-1</span>, preA = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    size_t pixelsWidth = <span class="built_in">CGRectGetWidth</span>(<span class="keyword">self</span>.frame);</span><br><span class="line">    size_t pixelsHeight = <span class="built_in">CGRectGetHeight</span>(<span class="keyword">self</span>.frame);</span><br><span class="line">    <span class="keyword">int</span> x = point.x;</span><br><span class="line">    <span class="keyword">int</span> y = point.y;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGFloat</span> scale = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">CGSize</span> size = <span class="built_in">CGSizeMake</span>(<span class="keyword">self</span>.frame.size.width*scale, <span class="keyword">self</span>.frame.size.height*scale) ;</span><br><span class="line">    <span class="keyword">int</span> bitPerRow = size.width * <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">int</span> bitCount = bitPerRow * size.height;</span><br><span class="line">    <span class="built_in">UInt8</span> *bitdata = malloc(bitCount);</span><br><span class="line">    <span class="keyword">if</span> (bitdata == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CGPointMake</span>(<span class="number">-1</span>, INT_MAX);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGColorSpaceRef</span> deviceRGB = <span class="built_in">CGColorSpaceCreateDeviceRGB</span>();</span><br><span class="line">    <span class="keyword">if</span> (deviceRGB == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CGPointMake</span>(<span class="number">-1</span>, INT_MAX);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGContextRef</span> contex = <span class="built_in">CGBitmapContextCreate</span>(bitdata, size.width, size.height, <span class="number">8</span>, bitPerRow, deviceRGB, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);</span><br><span class="line">    <span class="keyword">if</span> (contex == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">CFRelease</span>(deviceRGB);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">CGPointMake</span>(<span class="number">-1</span>, INT_MAX);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CFRelease</span>(deviceRGB);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGContextTranslateCTM</span>(contex, <span class="number">0</span>, size.height);</span><br><span class="line">    <span class="built_in">CGContextScaleCTM</span>(contex, scale, -scale);</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.layer renderInContext:contex];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> i = (direction==eFindPureSeparateLinePointDirection_down)?<span class="number">1</span>:<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &gt;= pixelsHeight || y &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            x = <span class="number">-1</span>;</span><br><span class="line">            y = INT_MAX;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (x &gt;= pixelsWidth) &#123;</span><br><span class="line">            x = point.x;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> offset = <span class="number">4</span>*((pixelsWidth*round(y))+round(x));</span><br><span class="line">        <span class="keyword">if</span> (preR == <span class="number">-1</span>) &#123;</span><br><span class="line">            preR = bitdata[offset];</span><br><span class="line">            preG = bitdata[offset+<span class="number">1</span>];</span><br><span class="line">            preB = bitdata[offset+<span class="number">2</span>];</span><br><span class="line">            preA = bitdata[offset+<span class="number">3</span>];</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (preR != bitdata[offset] ||</span><br><span class="line">                preG != bitdata[offset+<span class="number">1</span>] ||</span><br><span class="line">                preB != bitdata[offset+<span class="number">2</span>] ||</span><br><span class="line">                preA != bitdata[offset+<span class="number">3</span>]) &#123;</span><br><span class="line"></span><br><span class="line">                x = point.x;</span><br><span class="line">                y += i;</span><br><span class="line">                preR = <span class="number">-1</span>, preG = <span class="number">-1</span>, preB = <span class="number">-1</span>, preA = <span class="number">-1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                x++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CGContextRelease</span>(contex);</span><br><span class="line">    free(bitdata);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">CGPointMake</span>(x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>

        </div>
      </article>
    </div>
    <!-- Comments -->
    <div class="container">
      
<section id="comment">
  <!-- <h1 class="title">Comments</h1> -->

  
</section>


    </div>
    <!-- Pre or Next -->
    <div class="nav-links">
      
        <div class="nav-previous">
          <a href="/2017/06/29/iOS-åˆè¯†ARKit/" rel="prev"><span class="meta-arraw meta-arraw-left"></span> Older Posts</a>
        </div>
      
      
        <div class="nav-next">
          <a href="/2017/03/25/iOS-JSSDK/" rel="prev">Newer Posts <span class="meta-arraw meta-arraw-right"></span></a>
        </div>
      
    </div>

  </div>
</div>


  <!-- Footer -->
  <!-- Footer-widgets -->
<div class="footer-widgets">
  <div class="row inside-wrapper">
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">å…³äºæœ¬ç«™</h1>
        <div class="custom-widget-content">
          
          æƒ³å†™ä»€ä¹ˆå†™ä»€ä¹ˆï¼Œblablabla
        </div>
      </aside>
    </div>
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">Contact</h1>
        <div class="widget-text">
          
            
              <a href="https://github.com/JaonFanwt" class="icon icon-github" target="_blank">github</a>
            
          
        </div>
      </aside>
    </div>
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">Search</h1>
        <div class="widget-text">
          <form onSubmit="return appDaily.submitSearch('')">
            <p>
              <input type="text" placeholder="search..." id="homeSearchInput">
            </p>
            <!-- <input type="submit" value="GO"> -->
          </form>
        </div>
      </aside>
    </div>
  </div>
</div>
<!-- Footer -->
<footer class="site-info">
  <p>
    <span>Wttttttå¤© &copy; 2018</span>
    
      <span class="split">|</span>
      <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> with Theme <a href="https://github.com/GallenHu/hexo-theme-Daily" target="_blank">Daily</a></span>
    
  </p>
</footer>


  <!-- After footer scripts -->
  <!-- scripts -->
<script src="/js/app.js"></script>



</body>

</html>